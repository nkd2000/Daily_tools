<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text to Speech Converter | Free Online Tools</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Convert text to natural sounding speech online for free. Simple and fast text to speech tool with visualizer and text highlighting.">
    <meta name="keywords" content="text to speech, tts converter, voice generator, text highlighting, online speech tool, hindi text to speech">
    <meta name="author" content="Free Online Tools">

    <!-- Open Graph -->
    <meta property="og:title" content="Free Text to Speech Converter">
    <meta property="og:description" content="Turn text into lifelike speech instantly with audio visualizer and highlighter.">
    
    <!-- User's AdSense -->
    <meta name="google-adsense-account" content="ca-pub-3793390054330330">
    <script data-ad-client="ca-pub-3793390054330330" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; }
        .fade-in { animation: fadeIn 0.4s ease-out forwards; opacity: 0; transform: translateY(10px); }
        @keyframes fadeIn { to { opacity: 1; transform: translateY(0); } }
        
        /* Highlight Animation */
        .word-highlight {
            background-color: #fef08a; /* yellow-200 */
            color: #854d0e; /* yellow-800 */
            border-radius: 2px;
            padding: 0 1px;
            transition: background-color 0.1s;
            text-decoration: underline;
            text-decoration-color: #ca8a04;
            text-decoration-thickness: 2px;
        }

        /* Wave Animation */
        .bar {
            width: 8px;
            background: #22d3ee; /* cyan-400 */
            border-radius: 4px;
            height: 10px;
            transition: height 0.1s ease;
        }
        
        .speaking .bar {
            animation: sound 500ms linear infinite alternate;
        }

        @keyframes sound {
            0% { height: 10px; opacity: 0.6; }
            100% { height: 60px; opacity: 1; }
        }
        
        /* Staggered delays for wave effect */
        .bar:nth-child(1) { animation-delay: 0ms; }
        .bar:nth-child(2) { animation-delay: 100ms; }
        .bar:nth-child(3) { animation-delay: 200ms; }
        .bar:nth-child(4) { animation-delay: 300ms; }
        .bar:nth-child(5) { animation-delay: 400ms; }
        .bar:nth-child(6) { animation-delay: 500ms; }
        .bar:nth-child(7) { animation-delay: 400ms; }
        .bar:nth-child(8) { animation-delay: 300ms; }
        .bar:nth-child(9) { animation-delay: 200ms; }
        .bar:nth-child(10) { animation-delay: 100ms; }
    </style>
</head>
<body class="bg-gray-50 text-slate-800 flex flex-col min-h-screen">

    <!-- Navigation -->
    <nav class="bg-white border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center gap-3">
                    <div class="bg-cyan-600 text-white p-2 rounded-lg">
                        <i class="fa-solid fa-volume-high"></i>
                    </div>
                    <span class="font-bold text-xl tracking-tight text-gray-900">Text2Speech</span>
                </div>
                <div class="flex items-center gap-6 text-sm font-medium text-gray-500">
                    <a href="index.html" class="hover:text-cyan-600 transition">Home</a>
                    <a href="https://jansuchnaforall.blogspot.com" target="_blank" class="hover:text-cyan-600 transition">Blog</a>
                    <a href="contact.html" class="hover:text-cyan-600 transition">Contact</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow max-w-5xl mx-auto px-4 py-8 sm:px-6 w-full">
        
        <!-- Header -->
        <div class="text-center mb-10">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-900 mb-3">Text to Speech Converter</h1>
            <p class="text-gray-500 text-lg max-w-2xl mx-auto">
                Type or paste text below. Select a voice and listen to it read aloud.
            </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 items-start">
            
            <!-- Left Column: Input / Highlight -->
            <div class="lg:col-span-7 space-y-6">
                
                <!-- Container -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden flex flex-col h-[500px] relative">
                    <div class="p-4 border-b border-gray-100 bg-gray-50 flex justify-between items-center">
                        <div class="flex items-center gap-3">
                            <h3 class="font-semibold text-gray-800"><i class="fa-solid fa-keyboard mr-2 text-cyan-500"></i>Enter Text</h3>
                            <button id="pasteBtn" class="text-xs bg-cyan-50 text-cyan-600 px-2 py-1 rounded hover:bg-cyan-100 transition">
                                <i class="fa-solid fa-paste mr-1"></i> Paste
                            </button>
                            <button id="sampleBtn" class="text-xs bg-gray-50 text-gray-600 px-2 py-1 rounded hover:bg-gray-100 transition">
                                Sample
                            </button>
                        </div>
                        <button id="clearBtn" class="text-xs text-red-500 hover:text-red-700 font-medium transition">
                            <i class="fa-solid fa-trash mr-1"></i> Clear
                        </button>
                    </div>
                    
                    <!-- Textarea (Editable) -->
                    <textarea id="textInput" class="flex-grow p-6 text-gray-700 text-lg resize-none border-none outline-none focus:bg-cyan-50/30 transition leading-relaxed" placeholder="Hello! Type something here and I will speak it for you..."></textarea>
                    
                    <!-- Highlight Display (Read Only - Hidden by default) -->
                    <div id="highlightDisplay" class="hidden flex-grow p-6 text-gray-700 text-lg leading-relaxed overflow-y-auto bg-cyan-50/10 whitespace-pre-wrap"></div>

                    <div class="p-3 border-t border-gray-100 bg-gray-50 text-right text-xs text-gray-400 flex justify-between items-center">
                        <span class="text-cyan-600 font-medium"><i class="fa-solid fa-floppy-disk mr-1"></i> Auto-saved</span>
                        <span><span id="charCount">0</span> characters</span>
                    </div>
                </div>
            </div>

            <!-- Right Column: Controls & Visualizer -->
            <div class="lg:col-span-5 space-y-6">
                
                <!-- Wave Visualizer Container -->
                <div class="bg-slate-900 rounded-xl shadow-lg p-6 flex flex-col items-center justify-center h-56 relative overflow-hidden transition-colors duration-500" id="visualizerContainer">
                    
                    <!-- Wave Bars -->
                    <div class="flex items-center justify-center gap-1.5 h-20" id="waveContainer">
                        <div class="bar"></div><div class="bar"></div><div class="bar"></div>
                        <div class="bar"></div><div class="bar"></div><div class="bar"></div>
                        <div class="bar"></div><div class="bar"></div><div class="bar"></div>
                        <div class="bar"></div>
                    </div>

                    <p id="statusText" class="mt-6 text-cyan-200 text-sm font-bold tracking-wide uppercase">Ready to Speak</p>
                </div>

                <!-- Settings Card -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                    <div class="p-5 border-b border-gray-100 bg-gray-50">
                        <h3 class="font-semibold text-gray-800"><i class="fa-solid fa-sliders mr-2 text-cyan-500"></i>Controls</h3>
                    </div>
                    <div class="p-6 space-y-6">
                        
                        <!-- Voice Select -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Select Voice</label>
                            <select id="voiceSelect" class="block w-full border-gray-300 rounded-lg shadow-sm focus:ring-cyan-500 focus:border-cyan-500 sm:text-sm p-2.5 border">
                                <option value="">Loading voices...</option>
                            </select>
                        </div>

                        <!-- Sliders -->
                        <div class="space-y-4">
                            <div>
                                <div class="flex justify-between mb-1">
                                    <label class="text-xs font-medium text-gray-600">Speed</label>
                                    <span id="rateVal" class="text-xs text-gray-400">1x</span>
                                </div>
                                <input type="range" id="rate" min="0.5" max="2" value="1" step="0.1" class="w-full h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-cyan-600">
                            </div>
                            <div>
                                <div class="flex justify-between mb-1">
                                    <label class="text-xs font-medium text-gray-600">Pitch</label>
                                    <span id="pitchVal" class="text-xs text-gray-400">1</span>
                                </div>
                                <input type="range" id="pitch" min="0" max="2" value="1" step="0.1" class="w-full h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-cyan-600">
                            </div>
                        </div>

                        <!-- Controls -->
                        <div class="grid grid-cols-2 gap-3">
                            <button id="speakBtn" class="col-span-2 w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-3 px-4 rounded-lg shadow transition duration-150 ease-in-out flex justify-center items-center gap-2">
                                <i class="fa-solid fa-play"></i> Speak
                            </button>
                            <button id="pauseBtn" class="w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-4 rounded-lg transition flex justify-center items-center gap-2" disabled>
                                <i class="fa-solid fa-pause"></i> Pause
                            </button>
                            <button id="stopBtn" class="w-full bg-red-50 hover:bg-red-100 text-red-600 font-medium py-2 px-4 rounded-lg transition flex justify-center items-center gap-2" disabled>
                                <i class="fa-solid fa-stop"></i> Stop
                            </button>
                        </div>

                    </div>
                </div>

                <div class="flex justify-center">
                    <button onclick="history.back()" class="text-gray-500 hover:text-gray-700 font-medium text-sm flex items-center">
                        <i class="fa-solid fa-arrow-left mr-2"></i> Back to Tools
                    </button>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-white border-t border-gray-200 mt-auto">
        <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
            <p class="text-center text-sm text-gray-500">
                &copy; 2023 Free Online Tools. <a href="privacy.html" class="text-cyan-600 hover:text-cyan-500">Privacy Policy</a>
            </p>
        </div>
    </footer>

    <script>
        (function() {
            const synth = window.speechSynthesis;
            const textInput = document.getElementById('textInput');
            const highlightDisplay = document.getElementById('highlightDisplay');
            
            const voiceSelect = document.getElementById('voiceSelect');
            const rateInput = document.getElementById('rate');
            const pitchInput = document.getElementById('pitch');
            const rateVal = document.getElementById('rateVal');
            const pitchVal = document.getElementById('pitchVal');
            
            const speakBtn = document.getElementById('speakBtn');
            const pauseBtn = document.getElementById('pauseBtn');
            const stopBtn = document.getElementById('stopBtn');
            const clearBtn = document.getElementById('clearBtn');
            const pasteBtn = document.getElementById('pasteBtn');
            const sampleBtn = document.getElementById('sampleBtn');
            
            const visualizerContainer = document.getElementById('visualizerContainer');
            const waveContainer = document.getElementById('waveContainer');
            const statusText = document.getElementById('statusText');
            const charCount = document.getElementById('charCount');

            let voices = [];
            window.currentUtterance = null; // Prevent GC
            
            // Load Saved Text
            const savedText = localStorage.getItem('tts_text');
            if(savedText) {
                textInput.value = savedText;
                charCount.textContent = savedText.length;
            }

            function populateVoices() {
                voices = synth.getVoices();
                voiceSelect.innerHTML = '';
                
                if(voices.length === 0) {
                    const option = document.createElement('option');
                    option.textContent = "Default Voice";
                    voiceSelect.appendChild(option);
                    return;
                }

                // Sort Hindi/Indian voices to top for better UX
                voices.sort((a, b) => {
                    const aScore = (a.lang.includes('hi') || a.lang.includes('IN')) ? 1 : 0;
                    const bScore = (b.lang.includes('hi') || b.lang.includes('IN')) ? 1 : 0;
                    return bScore - aScore;
                });

                voices.forEach(voice => {
                    const option = document.createElement('option');
                    option.textContent = `${voice.name} (${voice.lang})`;
                    option.setAttribute('data-name', voice.name);
                    voiceSelect.appendChild(option);
                });
            }

            populateVoices();
            if (speechSynthesis.onvoiceschanged !== undefined) {
                speechSynthesis.onvoiceschanged = populateVoices;
            }

            function speak() {
                // Cancel existing first to avoid stack
                synth.cancel();

                const text = textInput.value;
                if (text !== '') {
                    // Prepare Highlight View
                    const safeText = text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
                    // Add spans but keep line breaks visually
                    highlightDisplay.innerHTML = safeText.split(/(\s+)/).map(part => {
                         if (part.trim().length > 0) return `<span>${part}</span>`;
                         return part; 
                    }).join('');
                    
                    textInput.classList.add('hidden');
                    highlightDisplay.classList.remove('hidden');

                    // Update Visuals
                    waveContainer.classList.add('speaking');
                    statusText.textContent = "Speaking...";
                    
                    // Buttons State
                    speakBtn.disabled = true;
                    speakBtn.classList.add('opacity-50', 'cursor-not-allowed');
                    pauseBtn.disabled = false;
                    stopBtn.disabled = false;
                    pauseBtn.innerHTML = '<i class="fa-solid fa-pause"></i> Pause';

                    const speakText = new SpeechSynthesisUtterance(text);
                    window.currentUtterance = speakText; 
                    
                    // --- Highlight Logic ---
                    const spanElements = highlightDisplay.querySelectorAll('span');
                    
                    speakText.onboundary = (event) => {
                        if (event.name === 'word') {
                            // Basic approach: Find span near current char index
                            const prev = highlightDisplay.querySelector('.word-highlight');
                            if(prev) prev.classList.remove('word-highlight');

                            let charCount = 0;
                            for(let span of spanElements) {
                                const len = span.innerText.length;
                                // Add tolerance for spacing
                                if (charCount <= event.charIndex && event.charIndex < (charCount + len + 2)) {
                                    span.classList.add('word-highlight');
                                    span.scrollIntoView({ behavior: "smooth", block: "center" });
                                    break;
                                }
                                charCount += len;
                            }
                        }
                    };

                    // Event: Ended
                    speakText.onend = e => {
                        resetUI();
                    };

                    // Event: Error
                    speakText.onerror = e => {
                        // Ignore interruption errors
                        if (e.error !== 'interrupted' && e.error !== 'canceled') {
                             console.error('Speech Error:', e);
                             resetUI();
                        }
                    };

                    // Set Voice
                    const selectedVoiceName = voiceSelect.selectedOptions[0]?.getAttribute('data-name');
                    if(selectedVoiceName) {
                         const foundVoice = voices.find(v => v.name === selectedVoiceName);
                         if(foundVoice) speakText.voice = foundVoice;
                    }

                    speakText.rate = parseFloat(rateInput.value);
                    speakText.pitch = parseFloat(pitchInput.value);

                    synth.speak(speakText);
                } else {
                    alert("Please enter some text first.");
                }
            }

            function resetUI() {
                waveContainer.classList.remove('speaking');
                statusText.textContent = "Ready to Speak";
                
                speakBtn.disabled = false;
                speakBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                
                pauseBtn.disabled = true;
                stopBtn.disabled = true;
                pauseBtn.innerHTML = '<i class="fa-solid fa-pause"></i> Pause';
                
                // Show Editor again
                textInput.classList.remove('hidden');
                highlightDisplay.classList.add('hidden');
            }

            // Event Listeners
            speakBtn.addEventListener('click', () => {
                if(synth.paused) {
                    synth.resume();
                    waveContainer.classList.add('speaking');
                    statusText.textContent = "Speaking...";
                    pauseBtn.innerHTML = '<i class="fa-solid fa-pause"></i> Pause';
                    return;
                }
                speak();
            });

            pauseBtn.addEventListener('click', () => {
                if (synth.speaking && !synth.paused) {
                    synth.pause();
                    waveContainer.classList.remove('speaking');
                    statusText.textContent = "Paused";
                    pauseBtn.innerHTML = '<i class="fa-solid fa-play"></i> Resume';
                } else if (synth.paused) {
                    synth.resume();
                    waveContainer.classList.add('speaking');
                    statusText.textContent = "Speaking...";
                    pauseBtn.innerHTML = '<i class="fa-solid fa-pause"></i> Pause';
                }
            });

            stopBtn.addEventListener('click', () => {
                synth.cancel();
                resetUI();
            });

            // New Button Logic
            clearBtn.addEventListener('click', () => {
                if(textInput.value && confirm('Clear all text?')) {
                    textInput.value = '';
                    charCount.textContent = '0';
                    localStorage.removeItem('tts_text');
                    synth.cancel();
                    resetUI();
                }
            });

            pasteBtn.addEventListener('click', async () => {
                try {
                    const text = await navigator.clipboard.readText();
                    textInput.value = text;
                    charCount.textContent = text.length;
                    localStorage.setItem('tts_text', text);
                } catch (err) {
                    alert('Failed to paste. Please allow clipboard permissions.');
                }
            });

            sampleBtn.addEventListener('click', () => {
                const sample = "Hello! Welcome to Free Online Tools. This is a sample text to demonstrate the text-to-speech capability. You can change my voice, speed, and pitch from the settings.";
                textInput.value = sample;
                charCount.textContent = sample.length;
                localStorage.setItem('tts_text', sample);
            });

            // Input Updates & Auto Save
            rateInput.addEventListener('change', e => rateVal.textContent = e.target.value + 'x');
            pitchInput.addEventListener('change', e => pitchVal.textContent = e.target.value);
            
            textInput.addEventListener('input', e => {
                charCount.textContent = e.target.value.length;
                localStorage.setItem('tts_text', e.target.value);
            });

        })();
    </script>
</body>
</html>
